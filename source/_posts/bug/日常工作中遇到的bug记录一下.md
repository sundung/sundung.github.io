---
title: 日常工作中遇到的bug记录一下
date: 2021-07-23 18:44:12
tags: bug
---

## 问题:

1. 问题1:

前端写元素的字体大小为 10 px ,结果在线上看效果,不生效

原因:

谷歌游览器只支持最小字体为 12px

解决办法:

> 使用 scale() 来缩小字体

2. 问题2:

业务中前端有个场景,银行定制信使成功会触发老虎机抽奖,结果会造成调用两次老虎机,结果会给一个用户发两次奖

原因:

经过分析,发现会进入两次前端页面,前端的逻辑是只要进入页面就会调用老虎机,后台核销成功会给前端返回中奖结果.
这个过程,会执行两次,所以排查问题就定位在为什么会造成进入两次页面.
结果发现业务中会区分灰度用户和非灰度用户,如果灰度用户访问非灰度用户的环境,就会触发js方法 window.replace()
重新刷新页面

解决办法:

调用刷新页面的js方法返回一个标识,表明当前页面是否是已经刷新的页面了  


3. 问题3: 

    问题描述:点击按钮触发老虎机按钮抽奖(实物加香蕉),中奖弹窗,会弹出两次.

    原因:
    当点击第一个中奖弹窗的关闭按钮,这个关闭事件会,将实物的中奖信息置位空,然后会将中奖弹窗的控制显示与隐藏的变量变为空.弹框关闭事件有个动画效果,中奖实物信息变为空,弹窗还没有关闭,所以会再次触发render函数,重新渲染,又出现一个中香蕉的中奖弹窗.

    解决办法:
    使用 settimeout 定时任务,规避这个时间差的问题